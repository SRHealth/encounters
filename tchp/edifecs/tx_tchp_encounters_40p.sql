CREATE OR REPLACE VIEW srh_edifecs_dev.tx_tchp_encounters_40p
AS
SELECT 
 '40P' as c_40p_record
, 'SR' || lpad(ird.ride_id, 16, '0') as c_40p_key
, row_number() over (partition by ird.ride_id order by ird.ride_id asc) as c_2400p_lx01_linecounter
, 'HC' as c_2400p_sv101_01_servicecodetype
,vtpc.procedure_code  as c_2400p_sv101_02_servicecode
,''  as c_2400p_sv101_03_servicemodifier1
, '' as c_2400p_sv101_04_servicemodifier2
, '' as c_2400p_sv101_05_servicemodifier3
, '' as c_2400p_sv101_06_servicemodifier4
, '' as c_2400p_sv101_07_servicecodedescription
, coalesce(ird.trip_cost, 0) + coalesce(ird.adjustment_amount, 0) as c_2400p_sv102_linecharge
, 'UN' as c_2400p_sv103_serviceunitmeasure
, '' as c_2400p_sv104_quantity -- insert mileage here 
, '' as c_2400p_sv105_placeofservice
, '1' as c_2400p_sv107_01_diagnosispointer
, '' as c_2400p_sv107_02_diagnosispointer
, '' as c_2400p_sv107_03_diagnosispointer
, '' as c_2400p_sv107_04_diagnosispointer
, '' as c_2400p_sv109_emergencyservice
, '' as c_2400p_sv111_epsdtservice
, '' as c_2400p_sv112_familyplanningservice
, '' as c_2400p_sv115_copayexempt
, '' as c_2400p_sv501_01_servicecodetype
, '' as c_2400p_sv501_02_servicecode
, '' as c_2400p_sv502_serviceunitmeasure
, '' as c_2400p_sv503_lengthmedicalnecessity
, '' as c_2400p_sv504_rentalprice
, '' as c_2400p_sv505_purchaseprice
, '' as c_2400p_sv506_rentalunitprice
, '' as c_2400p_pwk01_reporttype
, '' as c_2400p_pwk02_transmissioncode
, '' as c_2400p_pwk05_codequalifier
, '' as c_2400p_pwk06_controlnumber
, '' as c_2400p_cr101_patientweightqualifier
, '' as c_2400p_cr102_patientweight_
, '' as c_2400p_cr104_transportreason
, '' as c_2400p_cr105_servicemeasurecode
, '' as c_2400p_cr106_distance
, '' as c_2400p_cr110_stretcherpurpose
, '472' as c_2400p_dtp01_datetimequalifier_1
, 'D8' as c_2400p_dtp02_formatqualifier_1
, to_char(ird.ride_start_date, 'YYYYMMDD') as c_2400p_dtp03_date_1
, '' as c_2400p_dtp01_datetimequalifier_2
, '' as c_2400p_dtp02_formatqualifier_2
, '' as c_2400p_dtp03_date_2
, '' as c_2400p_dtp01_datetimequalifier_3
, '' as c_2400p_dtp02_formatqualifier_3
, '' as c_2400p_dtp03_date_3
, '' as c_2400p_dtp01_datetimequalifier_4
, '' as c_2400p_dtp02_formatqualifier_4
, '' as c_2400p_dtp03_date_4
, '' as c_2400p_dtp01_datetimequalifier_5
, '' as c_2400p_dtp02_formatqualifier_5
, '' as c_2400p_dtp03_date_5
, '' as c_2400p_dtp01_datetimequalifier_6
, '' as c_2400p_dtp02_formatqualifier_6
, '' as c_2400p_dtp03_date_6
, '' as c_2400p_dtp01_datetimequalifier_7
, '' as c_2400p_dtp02_formatqualifier_7
, '' as c_2400p_dtp03_date_7
, '' as c_2400p_dtp01_datetimequalifier_8
, '' as c_2400p_dtp02_formatqualifier_8
, '' as c_2400p_dtp03_date_8
, '' as c_2400p_dtp01_datetimequalifier_9
, '' as c_2400p_dtp02_formatqualifier_9
, '' as c_2400p_dtp03_date_9
, '' as c_2400p_dtp01_datetimequalifier_10
, '' as c_2400p_dtp02_formatqualifier_10
, '' as c_2400p_dtp03_date_10
, '' as c_2400p_dtp01_datetimequalifier_11
, '' as c_2400p_dtp02_formatqualifier_11
, '' as c_2400p_dtp03_date_11
, 'PT' as c_2400p_qty01_quantityqualiferid_1 -- attendant by age 
, '1' as c_2400p_qty02_quantity_1
, '' as c_2400p_qty01_quantityqualiferid_2
, '' as c_2400p_qty02_quantity_2
, '' as c_2400p_mea01_measurementidentifiercode_1
, '' as c_2400p_mea02_measurementqualifier_1
, '' as c_2400p_mea03_measurementvalue_1
, '' as c_2400p_mea01_measurementidentifiercode_2
, '' as c_2400p_mea02_measurementqualifier_2
, '' as c_2400p_mea03_measurementvalue_2
, '' as c_2400p_mea01_measurementidentifiercode_3
, '' as c_2400p_mea02_measurementqualifier_3
, '' as c_2400p_mea03_measurementvalue_3
, '' as c_2400p_mea01_measurementidentifiercode_4
, '' as c_2400p_mea02_measurementqualifier_4
, '' as c_2400p_mea03_measurementvalue_4
, '' as c_2400p_mea01_measurementidentifiercode_5
, '' as c_2400p_mea02_measurementqualifier_5
, '' as c_2400p_mea03_measurementvalue_5
, '' as c_2400p_cn101_contracttype
, '' as c_2400p_cn102_contractamount
, '' as c_2400p_cn103_contractpercentage
, '' as c_2400p_cn104_contractcode
, '' as c_2400p_cn105_termsdiscountpercent
, '' as c_2400p_cn106_contractversionidentifier
, '' as c_2400p_ref01_servicerefnumberqualifier_1
, '' as c_2400p_ref02_servicerefnumber_1
, '' as c_2400p_ref01_servicerefnumberqualifier_2
, '' as c_2400p_ref02_servicerefnumber_2
, '' as c_2400p_ref01_servicerefnumberqualifier_3
, '' as c_2400p_ref02_servicerefnumber_3
, '' as c_2400p_ref01_servicerefnumberqualifier_4
, '' as c_2400p_ref02_servicerefnumber_4
, '' as c_2400p_ref01_servicerefnumberqualifier_5
, '' as c_2400p_ref02_servicerefnumber_5
, '' as c_2400p_ref01_servicerefnumberqualifier_6
, '' as c_2400p_ref02_servicerefnumber_6
, '' as c_2400p_ref01_servicerefnumberqualifier_7
, '' as c_2400p_ref02_servicerefnumber_7
, '' as c_2400p_ref01_servicerefnumberqualifier_8
, '' as c_2400p_ref02_servicerefnumber_8
, '' as c_2400p_ref04_01_assignedbyqualifier_8
, '' as c_2400p_ref04_02_assignedby_8
, '' as c_2400p_ref01_servicerefnumberqualifier_9
, '' as c_2400p_ref02_servicerefnumber_9
, '' as c_2400p_ref04_01_assignedbyqualifier_9
, '' as c_2400p_ref04_02_assignedby_9
, '' as c_2400p_amt01_amountqualfier_1
, '' as c_2400p_amt02_amount_1
, '' as c_2400p_amt01_amountqualfier_2
, '' as c_2400p_amt02_amount_2
, '' as c_2400p_k301_fixedformatinformation_1
, '' as c_2400p_k301_fixedformatinformation_2
, '' as c_2400p_k301_fixedformatinformation_3
, '' as c_2400p_k301_fixedformatinformation_4
, '' as c_2400p_k301_fixedformatinformation_5
, '' as c_2400p_k301_fixedformatinformation_6
, '' as c_2400p_k301_fixedformatinformation_7
, '' as c_2400p_k301_fixedformatinformation_8
, '' as c_2400p_k301_fixedformatinformation_9
, '' as c_2400p_k301_fixedformatinformation_10
, 'ADD' as c_2400p_nte01_notetype_1
, 'P01' as c_2400p_nte02_note_1
, '' as c_2400p_nte01_notetype_2
, '' as c_2400p_nte02_note_2
, '' as c_2400p_hcp01_pricingmethod
, '' as c_2400p_hcp02_repricedallowedamt
, '' as c_2400p_hcp03_repricedsavingamt
, '' as c_2400p_hcp04_repricingordid
, '' as c_2400p_hcp05_pricingrange
, '' as c_2400p_hcp06_apgpricingcode
, '' as c_2400p_hcp07_apgpricingamt
, '' as c_2400p_hcp09_servicetype
, '' as c_2400p_hcp10_approvedservicecode
, '' as c_2400p_hcp11_repricingunits
, '' as c_2400p_hcp12_repricingquantity
, '' as c_2400p_hcp13_rejectreasoncode
, '' as c_2400p_hcp14_policycompliancecode
, '' as c_2400p_hcp15_exceptioncode
, '' as c_2410p_lin02_drugcodetype
, '' as c_2410p_lin03_nationaldrugcode
, '' as c_2410p_ctp04_quantity
, '' as c_2410p_ctp05_01_units
, '' as c_2410p_ref01_referenceidqualifier
, '' as c_2410p_ref02_referenceidentifier
, '' as c_2420gp_nm101_providerrole
, '' as c_2420gp_nm102_personindicator
, '' as c_2420gp_n301_addressline1
, '' as c_2420gp_n302_addressline2
, '' as c_2420gp_n401_city
, '' as c_2420gp_n402_state
, '' as c_2420gp_n403_postalcode
, '' as c_2420gp_n404_country
, '' as c_2420hp_nm101_providerrole
, '' as c_2420hp_nm102_personindicator
, '' as c_2420hp_nm103_org_lastname
, '' as c_2420hp_n301_addressline1
, '' as c_2420hp_n302_addressline2
, '' as c_2420hp_n401_city
, '' as c_2420hp_n402_state
, '' as c_2420hp_n403_postalcode
, '' as c_2420hp_n404_country
, '' as c_2400p_pwk02_dmeattachmenttransmissioncode
, '' as c_2400p_cr301_certificationtypecode
, '' as c_2400p_cr303_durablemedicalequipmentduration
, '' as c_2400p_crc02_certificationconditionindicator
, '' as c_2400p_crc03_conditioncode
, '' as c_2400p_crc04_conditioncode
, '' as c_2400p_crc05_conditioncode
, '' as c_2400p_crc06_conditioncode
, '' as c_2400p_crc07_conditioncode
, '' as c_2400p_ref01_repricedlineitemreferencequalifier
, '' as c_2400p_ref02_repricedlineitemreferencenumber
, '' as c_2400p_ps101_purchasedserivceprovideridentifier
, '' as c_2400p_ps102_purchasedservicechargeamount
, '' as c_40p_filler_01
, '' as c_40p_filler_02
, '' as c_40p_filler_03
, '' as c_40p_filler_04
, '' as c_40p_filler_05
, '' as c_2420ap_nm101_providerrole
, '' as c_2420ap_nm102_personindicator
, '' as c_2420ap_nm103_lastname
, '' as c_2420ap_nm104_firstname
, '' as c_2420ap_nm105_middlename
, '' as c_2420ap_nm107_suffix
, '' as c_2420ap_nm108_provideridentifierqualifer
, '' as c_2420ap_nm109_provideridentifier
, '' as c_2420ap_prv03_providertaxonomy
, '' as c_2420ap_ref01_provideridentifierqualifer_1
, '' as c_2420ap_ref02_provideridentifier_1
, '' as c_2420ap_ref01_provideridentifierqualifer_2
, '' as c_2420ap_ref02_provideridentifier_2
, '' as c_2420ap_ref01_provideridentifierqualifer_3
, '' as c_2420ap_ref02_provideridentifier_3
, '' as c_2420bp_nm101_providerrole
, '' as c_2420bp_nm102_personindicator
, '' as c_2420bp_nm108_provideridentifierqualifer
, '' as c_2420bp_nm109_provideridentifier
, '' as c_2420bp_ref01_provideridentifierqualifer_1
, '' as c_2420bp_ref02_provideridentifier_1
, '' as c_2420bp_ref01_provideridentifierqualifer_2
, '' as c_2420bp_ref02_provideridentifier_2
, '' as c_2420cp_nm101_providerrole
, '' as c_2420cp_nm102_personindicator
, '' as c_2420cp_nm103_lastname
, '' as c_2420cp_nm108_provideridentifierqualifer
, '' as c_2420cp_nm109_provideridentifier
, '' as c_2420cp_n301_addressline1
, '' as c_2420cp_n302_addressline2
, '' as c_2420cp_n401_city
, '' as c_2420cp_n402_state
, '' as c_2420cp_n403_postalcode
, '' as c_2420cp_n404_country
, '' as c_2420cp_ref01_provideridentifierqualifer_1
, '' as c_2420cp_ref02_provideridentifier_1
, '' as c_2420cp_ref01_provideridentifierqualifer_2
, '' as c_2420cp_ref02_provideridentifier_2
, '' as c_2420dp_nm101_providerrole
, '' as c_2420dp_nm102_personindicator
, '' as c_2420dp_nm103_lastname
, '' as c_2420dp_nm104_firstname
, '' as c_2420dp_nm105_middlename
, '' as c_2420dp_nm107_suffix
, '' as c_2420dp_nm108_provideridentifierqualifer
, '' as c_2420dp_nm109_provideridentifier
, '' as c_2420dp_ref01_provideridentifierqualifer_1
, '' as c_2420dp_ref02_provideridentifier_1
, '' as c_2420dp_ref01_provideridentifierqualifer_2
, '' as c_2420dp_ref02_provideridentifier_2
, '' as c_2420dp_ref01_provideridentifierqualifer_3
, '' as c_2420dp_ref02_provideridentifier_3
, '' as c_2420ep_nm101_providerrole
, '' as c_2420ep_nm102_personindicator
, '' as c_2420ep_nm103_lastname
, '' as c_2420ep_nm104_firstname
, '' as c_2420ep_nm105_middlename
, '' as c_2420ep_nm107_suffix
, '' as c_2420ep_nm108_provideridentifierqualifer
, '' as c_2420ep_nm109_provideridentifier
, '' as c_2420ep_n301_addressline1
, '' as c_2420ep_n302_addressline2
, '' as c_2420ep_n401_city
, '' as c_2420ep_n402_state
, '' as c_2420ep_n403_postalcode
, '' as c_2420ep_n404_country
, '' as c_2420ep_ref01_provideridentifierqualifer_1
, '' as c_2420ep_ref02_provideridentifier_1
, '' as c_2420ep_ref01_provideridentifierqualifer_2
, '' as c_2420ep_ref02_provideridentifier_2
, '' as c_2420fp_nm101_providerrole
, '' as c_2420fp_nm102_personindicator
, '' as c_2420fp_nm103_lastname
, '' as c_2420fp_nm104_firstname
, '' as c_2420fp_nm105_middlename
, '' as c_2420fp_nm107_suffix
, '' as c_2420fp_nm108_provideridentifierqualifer
, '' as c_2420fp_nm109_provideridentifier
, '' as c_2420fp_ref01_provideridentifierqualifer_1
, '' as c_2420fp_ref02_provideridentifier_1
, '' as c_2420fp_ref01_provideridentifierqualifer_2
, '' as c_2420fp_ref02_provideridentifier_2
, '' as c_innetworkindicator_
, '' as c_servicelinecontractid
, '' as c_tplpaidamount
, '' as c_40p_filler_9
, '' as c_40p_filler_10
, '' as c_40p_filler_11
, '' as c_40p_filler_12
, '' as c_40p_filler_13
, '' as c_40p_filler_14
, '' as c_40p_filler_15
, '' as c_servicehealthplan
, '' as c_servicebenefitplan
, '' as c_serviceadministrativecounty
, '' as c_serviceresidencecounty
, '' as c_serviceeligibilitycode
, '' as c_servicesubprogram1
, '' as c_servicesubprogram2
, '' as c_servicesubprogram3
, '' as c_servicesubprogram4
, '' as c_servicearrangementcode
, '' as c_servicetribalcode
, '' as c_categoryofservice_
, '' as c_renderingproviderspeciality_
, '' as c_purchasedindicator_
, '' as c_bh_espdtindicator
, '' as c_mpiservicelocation
, '' as c_ebppcode01
, '' as c_ebppcode02_
, '' as c_ebppcode03_
, '' as c_ebppcode04
, '' as c_ebppcode05
, '' as c_ordering_provider_location_code
, '' as c_40p_mediatype
, '' as c_beneficiary_cost_sharing_status
, '' as c_out_of_pocket_maximum
, '' as c_ihse
, '' as c_ambuulancetransporttype
, '' as c_ambulanceappointmenttime
, '' as c_ambulancearrivaltime
, '' as c_ambulancedeparturetime
, '' as c_ambulancescheduledpickuptime
, '' as c_ambulancescheduleddropofftime
, '' as c_procedure_code_indicator
, '' as c_40p_servicing_provider_class
, '' as c_40p_servicing_provider_type
, '' as c_40p_service_category
, '' as c_40p_servicing_provider_zip_code
, '' as c_40p_epsdtcategory
, '' as c_40p_familyplanningindicatorcategory
, '' as c_2420ap_renderingprovider_taxid
, '' as c_2420ap_renderingprovider_specialty_desc
, '' as c_2400p_servicemodifier5
, '' as c_2410p_genericindicator
, '' as c_placeofservicedescription
, '' as c_2400p_crc02_certificationconditionindicator2
, '' as c_2400p_crc03_conditioncode2
, '' as c_2400p_crc04_conditioncode2
, '' as c_2400p_crc05_conditioncode2
, '' as c_2400p_crc06_conditioncode2
, '' as c_2400p_crc07_conditioncode2
, '' as c_2400p_crc02_certificationconditionindicator3
, '' as c_2400p_crc03_conditioncode3
, '' as c_2400p_crc04_conditioncode3
, '' as c_2400p_crc05_conditioncode3
, '' as c_2400p_crc06_conditioncode3
, '' as c_2400p_crc07_conditioncode3
, '' as c_2400p_crc02_dmecertificationconditionindicator
, '' as c_2400p_crc03_dmeconditioncode
, '' as c_2400p_crc04_dmeconditioncode
, '' as c_40p_noncoveredcharge
, '' as c_40p_void_reason
, '' as c_evvstarttime
, '' as c_evvendtime
, '' as c_evvkey
, '' as c_evvlocationtype
, '' as c_special_studies_code
, '' as c_servicepurchaselocation
, '' as c_servicereferringlocation
, '' as c_baseamount
, '' as c_dppsupppymtamount
, '' as c_2400p_pwk01_02_reporttype
, '' as c_2400p_pwk02_02_transmissioncode
, '' as c_2400p_pwk05_02_codequalifier
, '' as c_2400p_pwk06_02_controlnumber
, '' as c_2400p_pwk01_03_reporttype
, '' as c_2400p_pwk02_03_transmissioncode
, '' as c_2400p_pwk05_03_codequalifier
, '' as c_2400p_pwk06_03_controlnumber
, '' as c_2400p_pwk01_04_reporttype
, '' as c_2400p_pwk02_04_transmissioncode
, '' as c_2400p_pwk05_04_codequalifier
, '' as c_2400p_pwk06_04_controlnumber
, '' as c_2400p_pwk01_05_reporttype
, '' as c_2400p_pwk02_05_transmissioncode
, '' as c_2400p_pwk05_05_codequalifier
, '' as c_2400p_pwk06_05_controlnumber
, '' as c_2400p_pwk01_06_reporttype
, '' as c_2400p_pwk02_06_transmissioncode
, '' as c_2400p_pwk05_06_codequalifier
, '' as c_2400p_pwk06_06_controlnumber

FROM
 srh_edifecs_dev.careprovider_invoice_ride_details ird 

  inner join src_rds_saferide.rides r
    on r.id = ird.ride_id
  left join src_rds_saferide.drivers d
    on d.id = r.driverid
  left join src_rds_saferide.vehicle_company vc
    on vc.id = r.vehiclownerid 
  left join srh_ie2_ds.srh_mapping.vehicle_type_procedure_code vtpc on vtpc.vehicle_type = ird.transport    

WHERE      
1=1
and ird.zero_cost_ride = 0 and ird.transport in ('AMB','WCV')
AND ird.hospital_group_id = 238

WITH NO SCHEMA BINDING;